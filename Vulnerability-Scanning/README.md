# Vulnerability Scanning Automation Repository

This repository contains tools, scripts, and resources to automate vulnerability scanning for identifying security weaknesses in systems, applications, and networks.

---

## Sections:

### 1. **[Tools](./tools.md)**
   - A curated list of vulnerability scanning tools to automate network and application security scans.

### 2. **[Scripts](./scripts.md)**
   - Custom scripts to automate the execution of vulnerability scans using tools like Nmap, Nessus, OpenVAS, and others.
---
### 3. **[Configuration Files](./configs)**
   - A collection of reusable configuration files for Nmap, Nessus, OpenVAS, and more.

### **Nmap Exclusion File** (`nmap_exclusion.conf`)
   - This file defines IP addresses or subnets to be excluded from Nmap scans.

### **Nessus Scan Profile** (`nessus_scan_profile.json`)
   - A JSON file for automating Nessus scans with specific settings for scan targets, exclusions, and policies.

### **OpenVAS Scan Profile** (`openvas_scan_profile.xml`)
   - An XML configuration file for automating OpenVAS scans with parameters for IP ranges, exclusions, and timing.
---
### 4. **[Report Templates](./report_templates)**
   - Templates for documenting scan results in Markdown, LaTeX, and automated report generation scripts.

### **Markdown Scan Report Template** (`scan_report_template.md`)
   - A simple template to document scan results using Markdown. Ideal for quickly summarizing findings.

### **LaTeX Scan Report Template** (`scan_report_template.tex`)
   - A formal report template in LaTeX for generating high-quality PDF reports.

### **Nmap to HTML Report Generator** (`nmap_to_html.py`)
   - A Python script that converts Nmap scan results into an HTML report format. Useful for automating scan documentation.
     
## Usage

1. Customize the Markdown or LaTeX templates based on your environment.
2. Use the Python script to automatically generate HTML reports after scanning with Nmap.
---
### 5. **[Scan Scheduling Automation](./automation)**
   - Scripts to automate the scheduling of regular vulnerability scans using cron jobs or task schedulers.

### **Scheduling Nmap Scans with Cron** (`schedule_nmap_cron.sh`)

- **Description:** Bash script to schedule Nmap scans using cron.
- **Usage:** Customize the variables in the script and run it to add a cron job.

### **Scheduling OpenVAS Scans with Cron** (`schedule_openvas_cron.sh`)

- **Description:** Bash script to schedule OpenVAS scans using cron.
- **Usage:** Customize the variables and run the script to schedule the scan.

### **Scheduling Nessus Scans with Task Scheduler** (`schedule_nessus_scan.ps1`)

- **Description:** PowerShell script to schedule Nessus scans using Windows Task Scheduler.
- **Usage:** Modify the script as needed and run it with administrative privileges.

## Instructions

1. **Customize Variables:** Before running the scripts, edit them to set the correct targets, schedules, and script paths.

2. **Permissions:** Ensure you have the necessary permissions to add cron jobs (Linux) or scheduled tasks (Windows).

3. **Script Paths:** Make sure the scan scripts (`nmap_vuln_scan.sh`, `openvas_scan.sh`, `trigger_nessus_scan.ps1`) are accessible at the paths specified in the scheduling scripts.

## Cron Schedule Syntax

The `CRON_SCHEDULE` variable in the Bash scripts uses the following format:

Each of the five fields represents a time unit:

- **Minute:** The minute of the hour (0 - 59)
- **Hour:** The hour of the day (0 - 23)
- **Day of Month:** The day of the month (1 - 31)
- **Month:** The month (1 - 12)
- **Day of Week:** The day of the week (0 - 7, where Sunday is both 0 and 7)

### Examples:

1. **Every day at 2:30 AM:**
30 2 * * *
   
2. **Every Monday at 3:00 AM:**
0 3 * * 1
   
3. **First day of every month at midnight:**
0 0 1 * *
   
4. **Every Friday at 5:00 PM:**
0 17 * * 5
   
5. **Every 15 minutes:**
*/15 * * * *

### Special Symbols:

- **`*`** : Represents all values (e.g., every minute, every hour).
- **`*/10`** : Represents every X units (e.g., every 10 minutes).
- **`1-5`** : Represents a range of values (e.g., Monday to Friday).
- **`,`** : Represents specific values (e.g., `0,6` for Sunday and Saturday).

Use these cron schedule formats in your `CRON_SCHEDULE` variable within your scripts to control when the scans should run.

---
### 6. **[Risk Scoring and Prioritization](./risk_scoring)**
   - Tools for parsing scan results and assigning risk scores based on CVSS to prioritize remediation.

### **CVSS Score Parser** (`cvss_parser.py`)

- **Description:** Parses vulnerability scan results and categorizes them by CVSS score into Critical, High, Medium, and Low risk levels.
- **Usage:** Run the script with an input file containing vulnerability data in JSON format.

### **Vulnerability Risk Score Calculator** (`vulnerability_risk_score_calculator.py`)

- **Description:** Calculates the total risk score for each host by summing the CVSS scores for all vulnerabilities on that host.
- **Usage:** Run the script with an input file containing vulnerability data in JSON format to rank hosts by risk.

## Customization

1. **Vulnerability Data:** Ensure your input file contains CVSS scores for each vulnerability. The format can be customized to fit your scan results.
2. **Risk Levels:** Modify the `risk_level()` function in `cvss_parser.py` to adjust the thresholds for Critical, High, Medium, and Low risks based on your organization's needs.

---
### 7. **[Documentation](./docs)**
   - Best practices for vulnerability scanning and integrating it into a patch management workflow.

### **Vulnerability Scanning Best Practices** (`vulnerability_scanning_best_practices.md`)

- **Description:** A guide to best practices for conducting vulnerability scans, including scheduling, prioritization, and remediation strategies.

### **Patch Management Workflow** (`patch_management_workflow.md`)

- **Description:** Outlines a workflow for integrating vulnerability scans into your organization's patch management process, helping prioritize vulnerabilities and ensure effective remediation.

## Usage

1. Follow the guidelines in `vulnerability_scanning_best_practices.md` to ensure your scans are thorough and effective.
2. Use the `patch_management_workflow.md` document to implement a systematic approach to addressing vulnerabilities through patching and mitigation.

---
### 8. **[Visualizations](./visualizations)**
   - Scripts for visualizing scan results and vulnerability trends using charts and graphs.

---

## Purpose

Vulnerability scanning is a critical part of security management, helping to identify, assess, and mitigate security weaknesses in your infrastructure. This repository provides automation tools and scripts to help streamline the vulnerability scanning process.

### Contributing

Contributions are welcome! Feel free to submit pull requests with new tools, scripts, or improvements.

### License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

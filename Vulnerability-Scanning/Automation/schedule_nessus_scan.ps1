# Schedule Nessus Scan using Windows Task Scheduler

# Variables
$taskName = "NessusScan"
$scriptPath = "C:\path\to\trigger_nessus_scan.ps1"  # Path to your Nessus scan script
$arguments = "-Target 192.168.1.0/24"               # Arguments for the scan script
$trigger = New-ScheduledTaskTrigger -Weekly -DaysOfWeek Monday -At 2am
$action = New-ScheduledTaskAction -Execute "powershell.exe" -Argument "-File `"$scriptPath`" $arguments"
$principal = New-ScheduledTaskPrincipal -UserId "SYSTEM" -LogonType ServiceAccount -RunLevel Highest

# Register the scheduled task
Register-ScheduledTask -TaskName $taskName -Action $action -Trigger $trigger -Principal $principal -Description "Scheduled Nessus Scan"

Write-Host "Scheduled task '$taskName' created to run Nessus scan every Monday at 2 AM."

import json

# Calculate total risk score for a given host
def calculate_total_risk(vulns):
    risk_by_host = {}

    for vuln in vulns:
        host = vuln['host']
        cvss_score = vuln.get('cvssScore', 0)

        if host not in risk_by_host:
            risk_by_host[host] = 0

        risk_by_host[host] += cvss_score

    return risk_by_host

def display_risk_by_host(risk_by_host):
    print("Risk Score by Host:")
    for host, risk_score in risk_by_host.items():
        print(f"Host: {host} - Total Risk Score: {risk_score}")

if __name__ == "__main__":
    vuln_file = "vulnerabilities.json"  # Input JSON file with vulnerabilities
    with open(vuln_file, 'r') as f:
        vulns = json.load(f)

    risk_by_host = calculate_total_risk(vulns)
    display_risk_by_host(risk_by_host)

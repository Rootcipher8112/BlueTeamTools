# Vulnerability Scanning Scripts

This document contains Python and Bash scripts to automate vulnerability scanning using popular tools like Nmap, Nessus, and OpenVAS.

---

### 1. **Automated Nmap Vulnerability Scan (Bash)**
   - **Description:** A Bash script to run a vulnerability scan using Nmap's built-in NSE scripts and generate a report.
   - **Use Case:** Automate network vulnerability scanning and reporting with Nmap.
   - **Example Usage:**
     ```bash
     ./nmap_vuln_scan.sh 192.168.1.0/24
     ```
   - **Code:**
     ```bash
     #!/bin/bash
     target="$1"  # Target IP or subnet to scan

     if [ -z "$target" ]; then
         echo "Usage: $0 <target>"
         exit 1
     fi

     echo "Running Nmap vulnerability scan on $target..."
     nmap -sV --script vuln -oN nmap_vuln_report.txt $target
     echo "Scan complete. Report saved to nmap_vuln_report.txt."
     ```

---

### 2. **Automated Nessus Scan Trigger (Python)**
   - **Description:** A Python script to trigger Nessus vulnerability scans via its REST API and download the results.
   - **Use Case:** Automate vulnerability scans on critical assets by interacting with Nessus API.
   - **Example Usage:**
     ```bash
     python trigger_nessus_scan.py --target 192.168.1.100
     ```
   - **Code:**
     ```python
     import requests
     import argparse

     nessus_url = "https://nessus.local:8834"
     api_token = "YOUR_API_TOKEN"  # Replace with your Nessus API token

     def trigger_scan(target_ip):
         headers = {
             "X-ApiKeys": f"accessKey={api_token}"
         }

         # Define the scan payload
         scan_payload = {
             "uuid": "template_uuid",
             "settings": {
                 "name": f"Scan {target_ip}",
                 "text_targets": target_ip
             }
         }

         response = requests.post(f"{nessus_url}/scans", json=scan_payload, headers=headers, verify=False)

         if response.status_code == 200:
             print(f"Scan for {target_ip} initiated.")
         else:
             print(f"Failed to trigger scan: {response.status_code}")

     if __name__ == "__main__":
         parser = argparse.ArgumentParser(description="Trigger a Nessus scan.")
         parser.add_argument("--target", required=True, help="Target IP for the scan.")
         args = parser.parse_args()

         trigger_scan(args.target)
     ```

---

### 3. **OpenVAS Automated Scan (Bash)**
   - **Description:** A Bash script to automate OpenVAS vulnerability scanning on a target IP range.
   - **Use Case:** Automate OpenVAS scans and output a report in XML format.
   - **Example Usage:**
     ```bash
     ./openvas_scan.sh 192.168.1.0/24
     ```
   - **Code:**
     ```bash
     #!/bin/bash
     target="$1"  # Target IP or subnet to scan

     if [ -z "$target" ]; then
         echo "Usage: $0 <target>"
         exit 1
     fi

     echo "Starting OpenVAS scan on $target..."
     omp -u admin -w admin_pass --xml "<create_task><name>OpenVAS Scan</name><comment>Automated Scan</comment><target><ip>$target</ip></target></create_task>"
     echo "Scan initiated. Results will be saved as OpenVAS report."
     ```

---

### 4. **Qualys API Trigger (Python)**
   - **Description:** A Python script to trigger a vulnerability scan using Qualys API and retrieve the scan results.
   - **Use Case:** Automate vulnerability scans on cloud infrastructure via the Qualys Cloud API.
   - **Example Usage:**
     ```bash
     python qualys_trigger_scan.py --target 192.168.1.100
     ```
   - **Code:**
     ```python
     import requests
     import argparse

     qualys_url = "https://qualysapi.qualys.com"
     api_username = "YOUR_QUALYS_USERNAME"
     api_password = "YOUR_QUALYS_PASSWORD"

     def trigger_scan(target_ip):
         payload = {
             "action": "launch",
             "target": target_ip
         }

         response = requests.post(f"{qualys_url}/api/2.0/fo/scan/", auth=(api_username, api_password), data=payload)

         if response.status_code == 200:
             print(f"Qualys scan for {target_ip} triggered successfully.")
         else:
             print(f"Failed to trigger Qualys scan: {response.status_code}")

     if __name__ == "__main__":
         parser = argparse.ArgumentParser(description="Trigger a Qualys vulnerability scan.")
         parser.add_argument("--target", required=True, help="Target IP for the scan.")
         args = parser.parse_args()

         trigger_scan(args.target)
     ```

---

### 5. **Acunetix Web Application Scan (Python)**
   - **Description:** A Python script that triggers a web application scan using Acunetix API.
   - **Use Case:** Automate web application vulnerability scanning with Acunetix for websites and applications.
   - **Example Usage:**
     ```bash
     python acunetix_scan.py --url https://example.com
     ```
   - **Code:**
     ```python
     import requests
     import argparse

     acunetix_url = "https://acunetix.local/api/v1"
     api_token = "YOUR_ACUNETIX_API_TOKEN"

     def trigger_scan(target_url):
         headers = {
             "X-Auth": api_token
         }

         scan_payload = {
             "target": {
                 "address": target_url,
                 "description": "Automated Web Application Scan"
             }
         }

         response = requests.post(f"{acunetix_url}/scans", json=scan_payload, headers=headers, verify=False)

         if response.status_code == 201:
             print(f"Web application scan initiated for {target_url}")
         else:
             print(f"Failed to trigger Acunetix scan: {response.status_code}")

     if __name__ == "__main__":
         parser = argparse.ArgumentParser(description="Trigger an Acunetix web application scan.")
         parser.add_argument("--url", required=True, help="Target URL for the scan.")
         args = parser.parse_args()

         trigger_scan(args.url)
     ```

---

## Contributing

Feel free to contribute to this repository by suggesting new tools, scripts, or improvements. To contribute, simply create a pull request with your changes or open an issue to discuss further.

---

## License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.
  

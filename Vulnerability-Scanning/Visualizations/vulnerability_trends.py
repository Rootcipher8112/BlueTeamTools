import matplotlib.pyplot as plt
from datetime import datetime

def visualize_vulnerability_trends(scan_history):
    dates = [datetime.strptime(entry['date'], "%Y-%m-%d") for entry in scan_history]
    vulnerabilities = [entry['vulnerabilities'] for entry in scan_history]

    plt.figure(figsize=(10, 6))
    plt.plot(dates, vulnerabilities, marker='o', color='red')
    plt.title('Vulnerabilities Over Time')
    plt.xlabel('Date')
    plt.ylabel('Number of Vulnerabilities')
    plt.grid(True)
    plt.tight_layout()
    plt.show()

if __name__ == "__main__":
    # Example scan history (replace this with actual scan history data)
    scan_history = [
        {"date": "2024-01-01", "vulnerabilities": 15},
        {"date": "2024-02-01", "vulnerabilities": 12},
        {"date": "2024-03-01", "vulnerabilities": 8},
        {"date": "2024-04-01", "vulnerabilities": 6}
    ]

    visualize_vulnerability_trends(scan_history)
